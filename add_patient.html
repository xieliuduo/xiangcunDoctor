<!doctype html>  
<html> 
  
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no, email=no" />
     <link href="css/mobiscroll.core-2.5.2.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.animation-2.5.2.css" rel="stylesheet" type="text/css" />
    <link href="css/mobiscroll.android-ics-2.5.2.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="css/sygoc.css?v1.1" />
    
    <title>新增患者</title>  
</head>
 
<body>  
    <div class="container ms-controller" ms-controller="add_patient">  
        <div class="header">
            <a id="goBack" class="link-back link-l" href="my_patient.html" ></a>
            <span class="title">新增患者</span>
            <a class="link-r link-txt" ms-click="@addPatient"><span style="font-size: 0.8rem">保存</span></a>
        </div>
        <div class="header-div"></div>
        <div class="wrap one_patient">
            <div class="box patient_img ">
                <a id="postfiles" class="img_upload">
                    <img ms-attr="{src:@patient_img?@patient_img:'images/touxiang.png'}" alt="用户头像" />
                    <!--  <img src="images/img_photo.png" alt="用户头像" /> -->
                    <span class="photo_txt">头像</span>
                </a>
            </div>
            <ul class="one_patient-list">
                <li class="box item">
                    <span class="l">姓名</span> 
                    <span class="r"><input ms-duplex="@name" type="text" placeholder="请输入患者姓名" /></span> 
                </li>
                <li class="box item">
                    <span class="l">性别</span>
                    <span class="r">
                        <label><input class="u" ms-duplex="@sex" type="radio" value="M" name="sex">男</label>
                        <label><input class="u" ms-duplex="@sex" type="radio" value="F" name="sex">女</label>
                    </span>
                </li>
                <!-- <li class="box item">
                    <span class="l">出生日期</span>
                    <span class="r"><input id="appDate" ms-duplex="@birthday" type="text" placeholder="选择出生日期" /></span>
                </li> -->
                <li class="box item">
                    <span class="l">手机号</span>
                    <span class="r"><input ms-duplex="@mobile" type="text" placeholder="请输入手机号码" maxlength="11"/></span>
                </li>
                 <li class="box item">
                    <span class="l">身份证</span>
                    <span class="r"><input ms-duplex="@id_card" type="text" placeholder="请输入身份证号" maxlength="18"/></span>
                </li>
                <li class="box item">
                    <span class="l">身高(cm)</span>
                    <span class="r"><input ms-duplex="@height" type="number" placeholder="请输入身高" maxlength="3"/></span>
                </li>
                <li class="box item">
                    <span class="l">体重(kg)</span> 
                    <span class="r"><input ms-duplex="@weight" type="number" placeholder="请输入体重" maxlength="3"/></span>
                </li>
            </ul>
            <!--描述-->
          <!--   <div class="box item-txt">
                <span class="t">既往史</span>
                <div class="con">
                    <textarea id="textarea1" ms-focus="@textareaOnFocus" maxlength="200" ms-keyup="@textareaKeyup(1,200)" ms-input="@textareaInput(1,200)" ms-duplex="@jws" placeholder="请描述既往史"></textarea>
                    <span class="count">{{@jws_count}}/200</span>
                </div>
            </div> -->
            <div class="box item-txt">
                <span class="t">家族史</span>
                <div class="con">
                    <textarea id="textarea2" ms-focus="@textareaOnFocus" maxlength="200" ms-keyup="@textareaKeyup(2,200)"  ms-input="@textareaInput(2,200)"  ms-duplex="@jzs" placeholder="请描述家族史"></textarea>
                    <span class="count">{{@jzs_count}}/200</span>
                </div>
            </div>
            <div class="box item-txt">
                <span class="t">疾病史</span>
                <div class="con">
                    <textarea id="textarea3" ms-focus="@textareaOnFocus" maxlength="200" ms-keyup="@textareaKeyup(3,200)" ms-input="@textareaInput(3,200)"  ms-duplex="@jbs" placeholder="请描述家族史"></textarea>
                    <span class="count">{{@jbs_count}}/200</span>
                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery-1.9.1.js"></script>
    <script src="js/xs_utils.js"></script>
    <script src="js/avalon.modern.min.js"></script>
    <script src="js/layer_mobile/layer.js"></script>
    <script src="js/plupload/js/plupload.full.min.js"></script>
     <script src="./js/mobiscroll.core-2.5.2.js" type="text/javascript"></script>
        <script src="./js/mobiscroll.core-2.5.2-zh.js" type="text/javascript"></script>
        <script src="./js/mobiscroll.datetime-2.5.1.js" type="text/javascript"></script>
        <script src="./js/mobiscroll.datetime-2.5.1-zh.js" type="text/javascript"></script>
        <script src="./js/mobiscroll.android-ics-2.5.2.js" type="text/javascript"></script>
    <script src="js/add_patient.js"></script>
     <script src="js/add_patient_photo.js"></script>

    <script type="text/javascript">
        $(function(){
                Date.prototype.format = function(partten)
                        {
                            if(partten ==null||partten=='')
                            {
                                partten = 'y-m-d'    ;
                            }
                            var y = this.getYear();
                            var m = this.getMonth()+1;
                            var d = this.getDate();
                            var r = partten.replace(/y+/gi,y);
                            r = r.replace(/m+/gi,(m<10?"0":"")+m);
                            r = r.replace(/d+/gi,(d<10?"0":"")+d);
                            return r; 
                        }
                //调用方式
                     
                        console.log((new Date()).format("y-m-d"));
                  
                       


               var curr = new Date();
               var opt = {};
               opt.date = {
                   preset: 'date'
               };
               opt.default = {
                   theme: 'android-ics light', //皮肤样式
                   display: 'bottom', //显示方式 
                   mode: 'scroller', //日期选择模式
                   lang: 'zh',
                   minDate: new Date(1900, 1, 01, 01, 01),
                   maxDate: new Date(),
                   onSelect: function(event, inst) {
                      add_patient.birthday = inst.val;
                       //console.log(inst);
                   }
               };

               $("#appDate").val('').scroller('destroy').scroller($.extend(opt['date'], opt['default'])); 


               $.fn.pasteEvents = function(delay) {
                   if (delay == undefined) delay = 10;
                   return $(this).each(function() {
                       var $el = $(this);
                       $el.on("paste", function() {
                           $el.trigger("prepaste");
                           setTimeout(function() {
                               $el.trigger("postpaste");
                           }, delay);
                       });
                   });
               };

               $("#textarea1").on("postpaste", function() {
                   add_patient.jws_count = add_patient.jws.length;
                   if (add_patient.jws_count >= 200) {
                       add_patient.jws = add_patient.jws.substring(0, 200);
                       add_patient.jws_count = 200;
                   }
               }).pasteEvents();

               $("#textarea2").on("postpaste", function() {
                   add_patient.jzs_count = add_patient.jzs.length;
                   if (add_patient.jzs_count >= 200) {
                       add_patient.jzs = add_patient.jzs.substring(0, 200);
                       add_patient.jzs_count = 200;
                   }
               }).pasteEvents();

               $("#textarea3").on("postpaste", function() {
                   add_patient.jbs_count = add_patient.jbs.length;
                   if (add_patient.jbs_count >= 200) {
                       add_patient.jbs = add_patient.jbs.substring(0, 200);
                       add_patient.jbs_count = 200;
                   }
               }).pasteEvents();


             

        });
    </script>
</body>

</html>
